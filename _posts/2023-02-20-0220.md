---
published: true
title: "TIL-23-02-20"
categories: 
- TIL
tags:
- Java
---
## JVM의 메모리 구조
* 응용 프로그램이 실행되면, JVM은 시스템으로부터 프로그램을 수행하는데 필요한 메모리를 할당받고 JVM은 이 메모리를 용도에 따라 여러 영역으로 나누어 관리한다.

![KakaoTalk_20230220_172148184_02](https://user-images.githubusercontent.com/58727604/220052255-839ed38c-8e3c-4727-ac79-bc1c77790634.jpg)

**1. 메서드 영역**
- 클래스 정보와 클래스 변수가 저장되는 곳
- 프로그램 실행 중 어떤 클래스가 사용되면, JVM은 해당 클래스의 클래스파일(*.class)을 읽고 분석하여 클래스에 대한 정보를 이곳에 저장한다.

**2. 힙**
- 인스턴스가 생성되는 공간. 즉, 인스턴스 변수들이 생성되는 공간

**3. 호출스택(call stack 또는 execution stack)**
- 메서드의 작업에 필요한 메모리 공간을 제공한다.
- 메서드가 호출되면, 호출스택에 호출된 메서드를 위한 메모리가 할당되며 이 메모리는 메서드가 작업을 수행하는 동안 지역변수(매개변수 포함)들과 연산의 중간결과를 저장하는데 사용된다.
- 메서드가 작업을 마치면 할당되었던 메모리는 반환되어 비워진다.

### 호출스택의 특징
- 메서드가 호출되면 수행에 필요한 만큼의 메모리를 스택에 할당받는다.
- 메서드가 수행을 마치고 나면 사용했던 메모리를 반환하고 스택에서 제거된다.
- 호출스택의 제일 위에 있는 메서드가 현재 실행 중인 메서드이다.
- 아래에 있는 메서드가 바로 위의 메서드를 호출한 메서드다.

---
## 기본형 매개변수와 참조형 매개변수
* 자바에서는 메서드를 호출할 때 매개변수로 지정된 값을 메서드의 매개변수에 복사해서 넘겨준다.
* 매개변수 타입이 기본형일 때는 기본형 값이 복사되겠지만, 참조형이면 인스턴의 주소가 복사된다.

> **기본형 매개변수** 변수의 값을 읽기만 할 수 있다.
<br />
> **참조형 매개변수** 변수의 값을 읽고 변경할 수 있다.

![KakaoTalk_20230220_172148184_01](https://user-images.githubusercontent.com/58727604/220088179-bad8bc7b-0143-4944-81bd-9c2ac32c4796.jpg)

1. change 메서드가 호출되면서 'd.x'가 change 메서드의 매개변수 x에 복사됨
2. change 메서드에서 x의 값을 1000으로 변경
3. change 메서드가 종료되면서 매개변수 x는 스택에서 제외됨

![KakaoTalk_20230220_172148184](https://user-images.githubusercontent.com/58727604/220088726-a42db9ed-52eb-4b7d-8257-b0f4485d3fec.jpg)
1. change 메서드가 호출되면서 참조변수 d의 값(주소)이 매개변수 d에 복사됨
2. change 메서드에서 매개변수 d로 x의 값을 1000으로 변경
3. change 메서드가 종료되면서 매개변수 d는 스택에서 제거됨

* main 메서드의 참조변수 d와 change 메서드의 참조변수 d는 같은 객체를 가리키게 된다.
* 따라서 매개변수 d로 x의 값을 읽는 것과 변경하는 것이 모두 가능한 것이다.

---
## 참조형 반환타입
* 매개변수 뿐 아니라 반환타입도 참조형이 될 수 있다.
```java
static Data Copy(Data d){
    Data tmp = new Data();  //새로운 객체 tmp를 생성한다.
    tmp.x = d.x;            //d.x의 값을 tmp.x에 복사한다.
    
    return tmp;         //복사한 객체의 주소를 반환한다.
        }
```

* copy 메서드 내에서 생성한 객체를 main 메서드에서도 사용할 수 있으려면, 이렇게 새로운 객체의 주소를 반환해줘야 한다.
* 그렇지 않으면 copy 메서드가 종료되면서 새로운 객체의 참조가 사라지므로 더이상 이 객체를 사용할 수 없다.
* _반환타입이 '참조형'이라는 것은 메서드가 '객체의 주소'를 반환한다는 것을 의미한다._

---

## 재귀 호출
* 메서드의 내부에서 메서드 자신을 호출하는 것.
* 재귀호출을 하는 메서드를 '재귀 메서드'라 함.

### 재귀 호출의 특징
- 재귀호출은 반복문과 유사한 점이 많으며, 대부분의 재귀호출은 반복문으로 작성 가능함.
- 재귀호출은 반복문보다 수행시간이 오래 걸리므로 비효율적.
- 반면 알아보기 쉽고 간결하게 작성할 수 있어 논리적 오류가 발생할 확률이 적고 추후 수정도 용이하여 사용에 이점이 있음.
- 재귀호출에 드는 비용보다 재귀호출의 간결함이 주는 이득이 충분히 큰 경우에만 사용해야 함.

### 팩토리얼 구하기
- 팩토리얼이란? 재귀호출의 대표적인 예로, 한 숫자가 1이 될 때까지 1씩 감소해가면서 계속 곱해 나가는 것.
 
```
f(n) = n * f(n-1), 단 f(1) = 1   //팩토리얼을 수학적 메소드로 구현한 것
```

- 위의 메소드를 자바로 구현하면 다음과 같다.
```java
class FactorialTest {
    public static void main(String args[]) {
        int result = factorial (4);
        
        System.out.println(result);
    }
    
    static int factorial(int n){
        int result = 0;
        
        if (n == 1)
            result = 1;
        else
            result = n * factorial(n-1);    //다시 메서드 자신을 호출한다.
        return result;
    }
}
```








